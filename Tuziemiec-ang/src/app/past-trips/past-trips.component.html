<body>

    <div class="comment-form" *ngIf="enabled">
        <div class="icon right" (click)="closeCommentForm()">
            <svg xmlns="http://www.w3.org/2000/svg" 
                width="2rem"
                height="2rem"
                 fill="white" class="bi bi-x-circle" viewBox="0 0 16 16">
                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
              </svg>
        </div>

        <div class="Form_title">
            Oceń wycieczkę: <br>
            {{tripSelector.template.name}}
        </div>
            <form [formGroup]="commentForm" (ngSubmit)="onSubmit(this.tripSelector.id)">
                <ngb-rating formControlName="rating" [max]="5" [(rate)]="b_rating" [readonly]="false"></ngb-rating> <br>
                <div class="validate" *ngIf="rating.invalid && rating.touched">
                    <small *ngIf="rating.errors?.required">Ocena jest wymagana!</small>
                </div>

                <input formControlName="commentHeader" type="text" placeholder="Tytuł komentarza" ><br>
                <div class="validate" *ngIf="commentHeader.invalid && commentHeader.touched">
                    <small *ngIf="commentHeader.errors?.required">Nagłówek jest wymagany!</small>
                </div>

                <textarea formControlName="commentBody" type="text" placeholder="Komentarz" ></textarea><br>
                <div class="validate" *ngIf="commentBody.invalid && commentBody.touched">
                    <small *ngIf="commentBody.errors?.required">Treść komentarza jest wymagana!</small>
                </div>

                <button class="Button" type="submit" [disabled]="!commentForm.valid">Dodaj komentarz</button>
            </form>
    </div>

    <div [ngClass]="style">
        <div class="Text" *ngIf="pastTrips.length == 0">
            Nie uczestniczyłeś w żadnej wycieczce!
        </div>
        <div *ngIf="pastTrips.length != 0">
            <div class="wrapper">
                <div class="table-header">Nazwa</div>
                <div class="table-header">Miejsce</div>
                <div class="table-header">Data wycieczki</div>
                <div class="table-header">Ilość osób</div>
                <div class="table-header">Ocena</div>
                <div class="table-header"></div>
            </div>
        <hr>
            <div *ngFor="let trip of pastTrips">
               <div class="wrapper">
                    <div class="table-cell link" [routerLink]="['/trip', trip.id]"><b>{{trip.template.name}}</b></div>
                    <div class="table-cell">{{trip.template.place}}</div>
                    <div class="table-cell">{{trip.startDate}} - {{trip.endDate}}</div>
                    <div class="table-cell">{{trip.booking}} / {{trip.userLimit}}</div>
                    <div class="table-cell">{{trip.template.rating}}</div>
                    
                    <div class="table-cell icons">
                        <div class="icon" *ngIf="!isTripReviewed(trip.id)" (click)="openCommentForm(trip)">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-chat-right-text" viewBox="0 0 16 16">
                                <path d="M2 1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h9.586a2 2 0 0 1 1.414.586l2 2V2a1 1 0 0 0-1-1H2zm12-1a2 2 0 0 1 2 2v12.793a.5.5 0 0 1-.854.353l-2.853-2.853a1 1 0 0 0-.707-.293H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12z"/>
                                <path d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6zm0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
                              </svg>
                        </div>
    
                        <div class="icon" *ngIf="isTripReviewed(trip.id)">
                            <svg 
                            xmlns="http://www.w3.org/2000/svg" 
                            fill="currentColor" 
                            class="bi bi-check2" 
                            viewBox="0 0 16 16">
                                <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                              </svg>
                        </div>
                    </div>
                </div>        
            </div>
        </div>
    </div>
    
</body>
